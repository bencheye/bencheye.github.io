---
layout: post
title: "linux环境R及R包使用经验总结"
date: 2021-09-18
description: "linux环境安装R语言相对比较麻烦，安装R包也会经常报错，出现一些依赖包无法下载，或者某些必须的库缺少，导致无法安装，这篇文章主要总结一下安装clusterProfiler过程的一些问题。"
---

1. R语言安装问题

   1.1 源码编译

   ​		下载源包make编译，但是会有很多问题，不好搞；

   1.2 编译后打包下载

   ​		使用apt-get或者yum直接下载安装使用，很方便

   1.3 anaconda下载

   ​		使用anaconda安装，方便管理和后期迁移维护等，安装方法，可以去anaconda官网使用关键词搜索`r-base`选择一个channel进去，下面有包的安装方法，推荐使用`conda-forge`conda官方提供的包进行安装，这个版本的R语言较新，否则R版本过低可能会在后续出现一些包装不上、或者装的R包版本较低，一些函数无法使用。如果想要指定安装版本，用法如下：

   ```shell
   mamba install -c conda-forge r-base=4.0
   ```

   注意：安装建议使用mamba替换conda，速度很快

2. R包安装过程遇到的各种问题

   2.1 直接使用mamba安装R包

   ​		这种方法安装速度很快，很方便，但是存在很多包无法安装，或者安装成功后依然无法使用，比如`DOSE`和`ClusterProfiler`等。另外该平台也会有一些R包会指定只能某个版本的R语言才能安装，在安装的过程中会报错缺少某个依赖，但是依赖安装完成后，也继续不断报错缺少一些其他的依赖，依赖全部安装完成后会报错当前R版本无法安装该包。

   2.2 直接使用R语言在线安装R包

   ​		该方法大多数简单的包都可以较为方便的安装，缺点是速度较慢。但是一些较为复杂的包无法直接安装成功，比如`DOSE`，因为这些包依赖较多，安装过程中需要下载安装很多依赖包，中间会有些依赖包无法下载，或者无法安装。另外还有一个R包**`stringi`**，该包直接安装过程中，报错，缺少一个库，但是很多包都需要依赖该包，尝试的很多方法，最后发现，可以使用mamba安装该包。另外还有一个包，安装过程中缺少一个icu库，但是下载` icu4c-69_1-data-bin-l.zip`文件失败，这个问题解决方法如下：

   ```shell
   sudo apt install libicu52=52.1-6
   sudo apt-get install libicu-dev
   ```

   2.3 DOSE等依赖关系复杂包安装经验

   ​		依赖关系复杂的包，直接安装很难成功，可以先在源包，然后使用`install.packags('包文件')`安装，然后会报错告知缺少对应的依赖包，再使用R在线安装或者手动离线安装，即可以最终安装成功。

   2.4 不同版本R包问题

   ​		edgeR包中有一个plotMDS函数，该函数在低版本R包中没有计算`var_explained`变量解释度的功能，在我安装过程中发现R3.6默认安装的edgeR版本较低，与R4.1安装的edgeR存在两个版本差，所以使用过程中需要注意。

